<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <meta name="Description" content="AEM Sidekick Library!!!!" />
    <meta name="robots" content="noindex" />
    <base href="/" />

    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        font-family: sans-serif;
        background-color: #ededed;
        height: 100%;
      }
      
      helix-sidekick { display: none }
    </style>
    <title>Sidekick Library</title>
  </head>

  <body>
  <script>
  const params = new URLSearchParams(location.search);
  // Sidekick passes the full page URL (on aem.page or aem.live)
  const current = params.get('url');

  // Fallbacks if url isn't present (e.g., opened directly)
  const siteOrigin = current ? new URL(current).origin : location.origin;

  const el = document.createElement('sidekick-library');
  // Now 'base' is relative to the actual site, not the hlx host serving this iframe
  el.config = { base: `${siteOrigin}/docs/library/blocks.json` };
  document.body.prepend(el);
</script>
  </body>
</html>
